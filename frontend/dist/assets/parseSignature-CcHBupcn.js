import{O as b,bT as y,bH as w,a7 as x,bV as p,ch as z,ce as M,d4 as T,cg as d,d5 as k,$ as E,d6 as N,a6 as P,d7 as S,bw as B,ca as L,d8 as A}from"./index-lk4JT0QR.js";function $(t,e){if(t.length!==e.length)throw new b({expectedLength:t.length,givenLength:e.length});const i=[];for(let n=0;n<t.length;n++){const u=t[n],o=e[n];i.push(m(u,o))}return y(i)}function m(t,e,i=!1){if(t==="address"){const r=e;if(!w(r))throw new x({address:r});return p(r.toLowerCase(),{size:i?32:null})}if(t==="string")return z(e);if(t==="bytes")return e;if(t==="bool")return p(M(e),{size:i?32:1});const n=t.match(T);if(n){const[r,s,a="256"]=n,c=Number.parseInt(a,10)/8;return d(e,{size:i?32:c,signed:s==="int"})}const u=t.match(k);if(u){const[r,s]=u;if(Number.parseInt(s,10)!==(e.length-2)/2)throw new E({expectedSize:Number.parseInt(s,10),givenSize:(e.length-2)/2});return p(e,{dir:"right",size:i?32:null})}const o=t.match(N);if(o&&Array.isArray(e)){const[r,s]=o,a=[];for(let c=0;c<e.length;c++)a.push(m(s,e[c],!0));return a.length===0?"0x":y(a)}throw new P(t)}function C(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}function O(t){const{source:e}=t,i=new Map,n=new S(8192),u=new Map,o=({address:r,chainId:s})=>`${r}.${s}`;return{async consume({address:r,chainId:s,client:a}){const c=o({address:r,chainId:s}),g=this.get({address:r,chainId:s,client:a});this.increment({address:r,chainId:s});const f=await g;return await e.set({address:r,chainId:s},f),n.set(c,f),f},async increment({address:r,chainId:s}){const a=o({address:r,chainId:s}),c=i.get(a)??0;i.set(a,c+1)},async get({address:r,chainId:s,client:a}){const c=o({address:r,chainId:s});let g=u.get(c);return g||(g=(async()=>{try{const l=await e.get({address:r,chainId:s,client:a}),h=n.get(c)??0;return h>0&&l<=h?h+1:(n.delete(c),l)}finally{this.reset({address:r,chainId:s})}})(),u.set(c,g)),(i.get(c)??0)+await g},reset({address:r,chainId:s}){const a=o({address:r,chainId:s});i.delete(a),u.delete(a)}}}const H="0x6492649264926492649264926492649264926492649264926492649264926492";function R(t){const{address:e,data:i,signature:n,to:u="hex"}=t,o=y([B([{type:"address"},{type:"bytes"},{type:"bytes"}],[e,i,n]),H]);return u==="hex"?o:L(o)}function V(t){const{r:e,s:i}=A.Signature.fromCompact(t.slice(2,130)),n=+`0x${t.slice(130)}`,[u,o]=(()=>{if(n===0||n===1)return[void 0,n];if(n===27)return[BigInt(n),0];if(n===28)return[BigInt(n),1];throw new Error("Invalid yParityOrV value")})();return typeof u<"u"?{r:d(e,{size:32}),s:d(i,{size:32}),v:u,yParity:o}:{r:d(e,{size:32}),s:d(i,{size:32}),yParity:o}}export{O as c,C as d,$ as e,V as p,R as s};
