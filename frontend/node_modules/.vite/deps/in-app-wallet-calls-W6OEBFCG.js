import {
  sendAndConfirmTransaction
} from "./chunk-D37BV44T.js";
import "./chunk-IBXM4QFM.js";
import {
  sendBatchTransaction
} from "./chunk-7BPFXS23.js";
import {
  eth_getTransactionReceipt
} from "./chunk-RPLD6P3C.js";
import "./chunk-QWTK625L.js";
import "./chunk-ZTSTPI2U.js";
import "./chunk-IW3I3RWX.js";
import "./chunk-QCGN5F3I.js";
import "./chunk-237EVM5Y.js";
import "./chunk-J6NIOEGA.js";
import "./chunk-BREECRX7.js";
import "./chunk-PN6DQXIK.js";
import "./chunk-PANVS3XX.js";
import "./chunk-L4NN5UUQ.js";
import "./chunk-5AWZZDTC.js";
import "./chunk-EBPJZRGO.js";
import {
  randomBytesHex
} from "./chunk-S4ZD6P6T.js";
import "./chunk-YGHTSOJ2.js";
import "./chunk-OM2KKZMP.js";
import "./chunk-LPC2L23M.js";
import "./chunk-QMDVOU32.js";
import "./chunk-QFKZXB2I.js";
import {
  getRpcClient
} from "./chunk-X7CG3L2Z.js";
import "./chunk-DVNKWNZO.js";
import "./chunk-2CIJO3V3.js";
import "./chunk-UZAMIWMY.js";
import "./chunk-6SVI5C4W.js";
import "./chunk-ESTOX3EM.js";
import "./chunk-CCP6WQOA.js";
import "./chunk-HR2UIEMV.js";
import "./chunk-Z2MF3EIF.js";
import "./chunk-G24WGTAU.js";
import "./chunk-TU6UWWTV.js";
import "./chunk-3OXDSLPJ.js";
import "./chunk-TVKFAMBW.js";
import {
  LruMap
} from "./chunk-PPP72TBL.js";
import "./chunk-OS7ZSSJM.js";

// node_modules/thirdweb/dist/esm/wallets/in-app/core/eip5792/in-app-wallet-calls.js
var bundlesToTransactions = new LruMap(1e3);
async function inAppWalletSendCalls(args) {
  const { account, calls } = args;
  const transactions = calls.map((call) => ({
    ...call,
    chain: args.chain
  }));
  const hashes = [];
  const id = randomBytesHex(65);
  bundlesToTransactions.set(id, hashes);
  if (account.sendBatchTransaction) {
    const receipt = await sendBatchTransaction({
      account,
      transactions
    });
    hashes.push(receipt.transactionHash);
    bundlesToTransactions.set(id, hashes);
  } else {
    for (const tx of transactions) {
      const receipt = await sendAndConfirmTransaction({
        account,
        transaction: tx
      });
      hashes.push(receipt.transactionHash);
      bundlesToTransactions.set(id, hashes);
    }
  }
  return id;
}
async function inAppWalletGetCallsStatus(args) {
  const { chain, client, id } = args;
  const bundle = bundlesToTransactions.get(id);
  if (!bundle) {
    throw new Error("Failed to get calls status, unknown bundle id");
  }
  const request = getRpcClient({ chain, client });
  let status = "success";
  const receipts = await Promise.all(bundle.map((hash) => eth_getTransactionReceipt(request, { hash }).then((receipt) => ({
    blockHash: receipt.blockHash,
    blockNumber: receipt.blockNumber,
    gasUsed: receipt.gasUsed,
    logs: receipt.logs.map((l) => ({
      address: l.address,
      data: l.data,
      topics: l.topics
    })),
    status: receipt.status,
    transactionHash: receipt.transactionHash
  })).catch(() => {
    status = "pending";
    return null;
  })));
  return {
    atomic: false,
    chainId: chain.id,
    id,
    receipts: receipts.filter((r) => r !== null),
    status,
    statusCode: 200,
    version: "2.0.0"
  };
}
export {
  inAppWalletGetCallsStatus,
  inAppWalletSendCalls
};
//# sourceMappingURL=in-app-wallet-calls-W6OEBFCG.js.map
